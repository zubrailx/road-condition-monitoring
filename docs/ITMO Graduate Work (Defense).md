# Предзащита

## Слайд 1 (Титульник)

Здравствуйте, уважаемая комиссия. Меня зовут Кулаков Никита. Тема моей выпускной квалификационной работы: "Автоматизация отслеживания состояния дорожных покрытий при помощи мобильных устройств водителей".

## Слайд 2 (Проблема)

Проблема качества дорог является важной в наше время: она влияет как на безопасность водителей, так и на экономику, например, согласно исследованиям, из-за плохих дорог увеличивается стоимость содержания транспортных средств и время вождения. 

Кроме того, проведение несвоевременного ремонта увеличивает стоимость обслуживания дорожных участков. 

Перед проведение ремонтных работ предварительно необходимо выявить сами дефекты. Для этого, как правило, нанимаются бригады, подготавливаются передвижные лаборатории со сложными приборами, такими как ультрозвуковые датчики. Безусловно, такой подход, является достаточно точным, но требует большого количества времени и средств. Альтернативным ему является сбор данных при помощи мобильных устройств водителей. Благодаря своей простоте данный вариант может быть полезен, например, если нет возможности быстрой организации бригад, или если необходимо провести анализ на большой территории.

## Слайд 3 (Цели и задачи)

Целью работы является обеспечение частичного отказа от использования специализированной аппаратуры, предназначенной для сбора данных о состоянии дорог, благодаря ее замене на датчики мобильных устройств и увеличению объема собираемых данных. Это позволит упростить сам процесс сбора. Помимо этого система будет обрабатывать собранные данные для визуализации оценок состояния дорог.

Задачи приведены на слайде.

## Слайд 4 (Альтернативы)

Перед реализацией системы был осуществлен поиск и проведен анализ альтернатив для определения, существуют ли системы, решающие данную цель.

Были найдены следующие альтернативы:
- "Автострада" - формирует оценки по системе отзывов, оставляемых вручную, 
- "XWeather RoadAI" - проводит анализ при помощи камеры и сложных алгоритмов, сами результаты не являются общедоступными, и 
- "Дороги России" - формирует оценки при помощи акселерометра с мобильных устройств, на которых и производятся вычисления. Проект прекратил работу 10 лет назад, 

На слайде приведена таблица с критериями сравнения. 

Таким образом, на момент начала работы такой работающей системы не обнаружилось.

## Слайд 5 (Архитектура системы)

На данном слайде приведена архитектура системы. Помимо мобильного приложения, которое предназначено для сбора и визуализации результатов, в системе существуют сервис пользовательских запросов, сервис прогнозирования и сервис обработки результатов, последний отвечает за буферизированную вставку в базу данных.

Прогнозирование результатов было вынесено из мобильного приложения, чтобы снизить нагрузку на телефон. 

На рисунке показаны два пути данных: верхний и нижний.

- Верхний отвечает за получение результатов: соответствует типовой клиент-серверной модели, используется формат сериализации JSON.
- Нижний - за непосредственный сбор данных. Остановимся на нем по подробнее.

Итак, с мобильных приложений поступают данные акселерометра, гироскопа и GPS, далее, проксируясь с MQTT они попадают в топик monitoring Kafka, где считываются сервисами прогнозирования, которые записывают результаты в топик points, из которого сервисы обработки результатов вставляют результаты в СУБД Clickhouse.

Здесь используется формат Protobuf для снижения размера и увеличения скорости сериализации.

В общих словах, такая архитектура системы был выбрана, чтобы обеспечить горизонтальное масштабирование. Более детально, как и обоснование использованных компонентов системы, приведено в тексте ВКР.

Также отмечу, что далее основное время будет уделено процессу получения и обработки данных по причине ограниченности времени на выступление.

## Слайд 6 (Мобильное приложение)

На следующем слайде представлен интерфейс мобильного приложения, разработанного на Dart. 

Реализованы экраны:
- слева - просмотр карты с результатами с возможностью фильтрации. Чтобы не запрашивать те же данные с сервера при навигации, было реализовано кеширование. Также добавлены уведомления.
- далее - синхронизированные графики датчиков.
- третья - различные параметры конфигурации приложения.
- и наконец, страница с логами.

На верхней панели кнопки включения сбора данных датчиков и сети и просмотра логов. При отключении сети данные временно сохраняются локально.

## Слайд 7 (Мобильное приложение)

Также локальное сохранение было реализовано, поскольку на некоторых дорогах отсутствует интернет, что не позволяет в моменте связываться с сервером.

Рассмотрим процесс отправки:
1. Когда появляются новое значение, то есть возникает соответствующее ему событие, данные добавляются в буфер для отправки.
2. По наступлении времени при включенной сети буфер сериализуется и отправляется.
3. При возникновении ошибок или отсутствии сети данные сохраняются локально в файловой системе.

Таким образом, данные не теряются при отсутствии интернета или ошибках сети.

Когда появляется доступ к серверу, выполняется алгоритм для отправки данных с подтверждением, который показан справа.

## Слайд 8 (Сервис прогнозирования)

Сервис прогнозирования, реализован на языке Python. Язык выбран благодаря наличию требуемых библиотек.

Итак, KafkaConsumer считывает сообщение и создает задачу на выполнение группой процессов.

На слайде представлен механизм обработки задачи.

После десериализации сообщения, осуществляется линейная интерполяция, поскольку данные датчиков мобильных устройств не приходят в строго определенные моменты времени, например раз в 50 миллисекунд.

Далее эти данные разбиваются на окна, так как размерность входов алгоритмов фиксирована. Смещение меньше целого окна, чтобы не пропустить дефекты на дорогах, если они произошли на границе.

После этого окна избавляются от шумов при помощи фильтра низких частот, выполняется экстракция признаков с использованием фурье преобразования, выборка из них наиболее коррелирующих с результатом, и, наконец, прогнозирование при помощи алгоритма машинного обучения. Далее результаты отправляются.

Таким образом, из данных датчиков формируются точки с оценками дорог в заданных географических координатах.

## Слайд 9 (Тестирование системы)

Перейдем к тестированию системы.

Конфигурация представлена на экране.

Для нагрузочного тестирования был разработан сервис имитирующий работу нескольких мобильных устройств: он запускался на отдельном сервере, чтобы не создавать дополнительную нагрузку.

Результат тестирования следующий: 
- Отправлено 4200 сообщений с данными датчиков за 30 секунд.
- Время отправки составило 45 секунд.
- Получено 34 тысячи оценок.

## Слайд 10 (Тестирование системы)

На данном слайде представлены результаты тестирования различных алгоритмов регрессии: детерминированный (чтобы показать время без предобработки и инференции), деревья регрессии, XGBoost без признака скорости машины и с. Результаты сравнения представлены в таблице.

Выбор именно этих алгоритмов обусловлен задачей регрессии (а не классификации), малыми размерами модели и типом входных данных.

## Слайд 11 (Результаты на обучающих данных)

В результате, на основании скорости и малой погрешности с истинными значениями были выбраны модели XGBoost с различными атрибутами.

Для визуализации точек используется функция градиента, где 0 - красная (дорога плохая), 1 - зеленая (дорога хорошая).

Несмотря на то, что на рисунке XGBoost со скоростью показывает лучшие результаты, он не был выбран для использования, так как из-за неполного покрытия сценариев датасета, на реальных данных он менее чувствителен к дефектам на дорогам.

## Слайд 12 (Работа в реальных условиях)

На данном слайде вы можете видеть полученные результаты в реальных сценариях использования. На момент выступления сервис доступен: водители, используя мобильное приложение, могут помогать собирать данные о текущем состоянии дорог, а также видеть соответствующие результаты.

## Слайд 13 (Достигнутые результаты)

Таким образом, в результате выполнения ВКР были достигнуты следующие результаты:
- выполнен анализ предметной области и аналогов;
- разработана архитектура и реализованы необходимые компоненты системы для обеспечения сбора данных и визуализации результатов;
- так как использовались алгоритмы обучения, был найден датасет и обучены алгоритмы машинного обучения;
- далее, произведен анализ алгоритмов и нагрузочное тестирование, для этого разработана соответствующая обвязка
- и наконец, была проверена работа системы в реальных условиях, чтобы убедиться в достижении цели

## Слайд 14 (Дальнейшее развитие)

Проделанная работа открывает дальнейшие перспективы, которые представлены на слайде. Направления развития сгруппированы в соответствии с назначением элементов.

## Слайд 15 (Конец)

Ниже приведена ссылка на репозиторий с исходным кодом проекта. Спасибо за внимание.
